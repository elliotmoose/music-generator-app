{"ast":null,"code":"import _objectSpread from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nimport { isActiveAudioNode } from '../helpers/is-active-audio-node';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassive } from '../helpers/set-internal-state-to-passive';\nvar DEFAULT_OPTIONS = {\n  channelCount: 2,\n  channelCountMode: 'max',\n  channelInterpretation: 'speakers',\n  offset: 1\n};\nexport var createConstantSourceNodeConstructor = function createConstantSourceNodeConstructor(audioNodeConstructor, createAudioParam, createConstantSourceNodeRendererFactory, createNativeConstantSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener) {\n  return /*#__PURE__*/function (_audioNodeConstructor) {\n    _inherits(ConstantSourceNode, _audioNodeConstructor);\n\n    var _super = _createSuper(ConstantSourceNode);\n\n    function ConstantSourceNode(context, options) {\n      var _this;\n\n      _classCallCheck(this, ConstantSourceNode);\n\n      var nativeContext = getNativeContext(context);\n\n      var mergedOptions = _objectSpread(_objectSpread({}, DEFAULT_OPTIONS), options);\n\n      var nativeConstantSourceNode = createNativeConstantSourceNode(nativeContext, mergedOptions);\n      var isOffline = isNativeOfflineAudioContext(nativeContext);\n      var constantSourceNodeRenderer = isOffline ? createConstantSourceNodeRendererFactory() : null;\n      _this = _super.call(this, context, false, nativeConstantSourceNode, constantSourceNodeRenderer);\n      _this._constantSourceNodeRenderer = constantSourceNodeRenderer;\n      _this._nativeConstantSourceNode = nativeConstantSourceNode;\n      /*\n       * Bug #62 & #74: Safari does not support ConstantSourceNodes and does not export the correct values for maxValue and minValue\n       * for GainNodes.\n       */\n\n      _this._offset = createAudioParam(_assertThisInitialized(_this), isOffline, nativeConstantSourceNode.offset, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n      _this._onended = null;\n      return _this;\n    }\n\n    _createClass(ConstantSourceNode, [{\n      key: \"start\",\n      value: function start() {\n        var _this2 = this;\n\n        var when = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n        this._nativeConstantSourceNode.start(when);\n\n        if (this._constantSourceNodeRenderer !== null) {\n          this._constantSourceNodeRenderer.start = when;\n        }\n\n        if (this.context.state !== 'closed') {\n          setInternalStateToActive(this);\n\n          var resetInternalStateToPassive = function resetInternalStateToPassive() {\n            _this2._nativeConstantSourceNode.removeEventListener('ended', resetInternalStateToPassive);\n\n            if (isActiveAudioNode(_this2)) {\n              setInternalStateToPassive(_this2);\n            }\n          };\n\n          this._nativeConstantSourceNode.addEventListener('ended', resetInternalStateToPassive);\n        }\n      }\n    }, {\n      key: \"stop\",\n      value: function stop() {\n        var when = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n        this._nativeConstantSourceNode.stop(when);\n\n        if (this._constantSourceNodeRenderer !== null) {\n          this._constantSourceNodeRenderer.stop = when;\n        }\n      }\n    }, {\n      key: \"offset\",\n      get: function get() {\n        return this._offset;\n      }\n    }, {\n      key: \"onended\",\n      get: function get() {\n        return this._onended;\n      },\n      set: function set(value) {\n        var wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n        this._nativeConstantSourceNode.onended = wrappedListener;\n        var nativeOnEnded = this._nativeConstantSourceNode.onended;\n        this._onended = nativeOnEnded !== null && nativeOnEnded === wrappedListener ? value : nativeOnEnded;\n      }\n    }]);\n\n    return ConstantSourceNode;\n  }(audioNodeConstructor);\n};","map":{"version":3,"sources":["../../../src/factories/constant-source-node-constructor.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nimport { isActiveAudioNode } from '../helpers/is-active-audio-node';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassive } from '../helpers/set-internal-state-to-passive';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    offset: 1\n};\nexport const createConstantSourceNodeConstructor = (audioNodeConstructor, createAudioParam, createConstantSourceNodeRendererFactory, createNativeConstantSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener) => {\n    return class ConstantSourceNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeConstantSourceNode = createNativeConstantSourceNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const constantSourceNodeRenderer = ((isOffline ? createConstantSourceNodeRendererFactory() : null));\n            super(context, false, nativeConstantSourceNode, constantSourceNodeRenderer);\n            this._constantSourceNodeRenderer = constantSourceNodeRenderer;\n            this._nativeConstantSourceNode = nativeConstantSourceNode;\n            /*\n             * Bug #62 & #74: Safari does not support ConstantSourceNodes and does not export the correct values for maxValue and minValue\n             * for GainNodes.\n             */\n            this._offset = createAudioParam(this, isOffline, nativeConstantSourceNode.offset, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._onended = null;\n        }\n        get offset() {\n            return this._offset;\n        }\n        get onended() {\n            return this._onended;\n        }\n        set onended(value) {\n            const wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n            this._nativeConstantSourceNode.onended = wrappedListener;\n            const nativeOnEnded = this._nativeConstantSourceNode.onended;\n            this._onended = nativeOnEnded !== null && nativeOnEnded === wrappedListener ? value : nativeOnEnded;\n        }\n        start(when = 0) {\n            this._nativeConstantSourceNode.start(when);\n            if (this._constantSourceNodeRenderer !== null) {\n                this._constantSourceNodeRenderer.start = when;\n            }\n            if (this.context.state !== 'closed') {\n                setInternalStateToActive(this);\n                const resetInternalStateToPassive = () => {\n                    this._nativeConstantSourceNode.removeEventListener('ended', resetInternalStateToPassive);\n                    if (isActiveAudioNode(this)) {\n                        setInternalStateToPassive(this);\n                    }\n                };\n                this._nativeConstantSourceNode.addEventListener('ended', resetInternalStateToPassive);\n            }\n        }\n        stop(when = 0) {\n            this._nativeConstantSourceNode.stop(when);\n            if (this._constantSourceNodeRenderer !== null) {\n                this._constantSourceNodeRenderer.stop = when;\n            }\n        }\n    };\n};\n//# sourceMappingURL=constant-source-node-constructor.js.map"]},"metadata":{},"sourceType":"module"}