{"ast":null,"code":"import _regeneratorRuntime from\"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import'./App.css';import{useEffect,useState}from'react';import Player from'./Player';import*as Tone from'tone';var interval;function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),play=_useState2[0],setPlay=_useState2[1];var _useState3=useState(new Player()),_useState4=_slicedToArray(_useState3,2),player=_useState4[0],setPlayer=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),notes=_useState6[0],setNotes=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),playheadTime=_useState8[0],setPlayheadTime=_useState8[1];useEffect(function(){player.setup();setPlayer(player);if(!interval){setInterval(function(){setPlayheadTime(Tone.context.currentTime*DURATION_FACTOR);},10);}},[]);useEffect(function(){if(play){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=setNotes;_context.next=3;return player.notesFromMidiFile('ABeautifulFriendship.mid');case 3:_context.t1=_context.sent;(0,_context.t0)(_context.t1);_context.next=7;return player.playMidiFile('ABeautifulFriendship.mid');case 7:case\"end\":return _context.stop();}}},_callee);}))();setPlay(false);}},[play]);var MAX_MIDI=91;var NOTE_HEIGHT=20;var DURATION_FACTOR=100;return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setPlay(true);},children:\"begin\"}),notes.map(function(note,i){// const noteDescription = `${note.name} note: ${note.midi} dur:${note.duration} time:${note.time}`\nvar noteDescription=\"\".concat(note.name);return/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:note.time*DURATION_FACTOR-playheadTime,top:MAX_MIDI*NOTE_HEIGHT-note.midi*NOTE_HEIGHT,width:note.duration*DURATION_FACTOR,height:NOTE_HEIGHT,backgroundColor:'tomato'},children:noteDescription},\"\".concat(i));})]});}export default App;","map":{"version":3,"sources":["/Users/thebe/Desktop/music-generator-app/src/App.js"],"names":["useEffect","useState","Player","Tone","interval","App","play","setPlay","player","setPlayer","notes","setNotes","playheadTime","setPlayheadTime","setup","setInterval","context","currentTime","DURATION_FACTOR","notesFromMidiFile","playMidiFile","MAX_MIDI","NOTE_HEIGHT","map","note","i","noteDescription","name","position","left","time","top","midi","width","duration","height","backgroundColor"],"mappings":"kjBAAA,MAAO,WAAP,CACA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAO,GAAKC,CAAAA,IAAZ,KAAsB,MAAtB,CACA,GAAIC,CAAAA,QAAJ,CACA,QAASC,CAAAA,GAAT,EAAe,eACWJ,QAAQ,CAAC,KAAD,CADnB,wCACNK,IADM,eACAC,OADA,8BAEeN,QAAQ,CAAC,GAAIC,CAAAA,MAAJ,EAAD,CAFvB,yCAENM,MAFM,eAEEC,SAFF,8BAGaR,QAAQ,CAAC,EAAD,CAHrB,yCAGNS,KAHM,eAGCC,QAHD,8BAI2BV,QAAQ,CAAC,CAAD,CAJnC,yCAINW,YAJM,eAIQC,eAJR,eAMbb,SAAS,CAAC,UAAM,CACdQ,MAAM,CAACM,KAAP,GACAL,SAAS,CAACD,MAAD,CAAT,CAEA,GAAI,CAACJ,QAAL,CAAe,CACbW,WAAW,CAAC,UAAM,CAChBF,eAAe,CAACV,IAAI,CAACa,OAAL,CAAaC,WAAb,CAA2BC,eAA5B,CAAf,CACD,CAFU,CAER,EAFQ,CAAX,CAGD,CACF,CATQ,CASN,EATM,CAAT,CAWAlB,SAAS,CAAC,UAAM,CACd,GAAIM,IAAJ,CAAU,CAER,wDAAC,+IACCK,QADD,uBACgBH,CAAAA,MAAM,CAACW,iBAAP,CAAyB,0BAAzB,CADhB,qFAEOX,CAAAA,MAAM,CAACY,YAAP,CAAoB,0BAApB,CAFP,uDAAD,KAKAb,OAAO,CAAC,KAAD,CAAP,CACD,CACF,CAVQ,CAUN,CAACD,IAAD,CAVM,CAAT,CAYA,GAAMe,CAAAA,QAAQ,CAAG,EAAjB,CACA,GAAMC,CAAAA,WAAW,CAAG,EAApB,CACA,GAAMJ,CAAAA,eAAe,CAAG,GAAxB,CAIA,mBACE,aAAK,SAAS,CAAC,KAAf,wBACE,eAAQ,OAAO,CAAE,yBAAMX,CAAAA,OAAO,CAAC,IAAD,CAAb,EAAjB,mBADF,CAGGG,KAAK,CAACa,GAAN,CAAU,SAACC,IAAD,CAAOC,CAAP,CAAa,CACtB;AACA,GAAMC,CAAAA,eAAe,WAAMF,IAAI,CAACG,IAAX,CAArB,CACA,mBAAO,YAEL,KAAK,CAAE,CAAEC,QAAQ,CAAE,UAAZ,CAAwBC,IAAI,CAAEL,IAAI,CAACM,IAAL,CAAYZ,eAAZ,CAA8BN,YAA5D,CAA0EmB,GAAG,CAAEV,QAAQ,CAAGC,WAAX,CAAyBE,IAAI,CAACQ,IAAL,CAAYV,WAApH,CAAiIW,KAAK,CAAET,IAAI,CAACU,QAAL,CAAgBhB,eAAxJ,CAAyKiB,MAAM,CAAEb,WAAjL,CAA8Lc,eAAe,CAAE,QAA/M,CAFF,UAGLV,eAHK,YACGD,CADH,EAAP,CAID,CAPA,CAHH,GADF,CAeD,CAED,cAAepB,CAAAA,GAAf","sourcesContent":["import './App.css';\nimport { useEffect, useState } from 'react'\nimport Player from './Player';\nimport * as Tone from 'tone'\nlet interval;\nfunction App() {\n  const [play, setPlay] = useState(false)\n  const [player, setPlayer] = useState(new Player());\n  const [notes, setNotes] = useState([]);\n  const [playheadTime, setPlayheadTime] = useState(0);\n\n  useEffect(() => {\n    player.setup();\n    setPlayer(player);\n    \n    if (!interval) {\n      setInterval(() => {\n        setPlayheadTime(Tone.context.currentTime * DURATION_FACTOR)\n      }, 10);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (play) {\n\n      (async () => {\n        setNotes(await player.notesFromMidiFile('ABeautifulFriendship.mid'));\n        await player.playMidiFile('ABeautifulFriendship.mid');\n      })()\n\n      setPlay(false);\n    }\n  }, [play])\n\n  const MAX_MIDI = 91\n  const NOTE_HEIGHT = 20\n  const DURATION_FACTOR = 100\n\n\n\n  return (\n    <div className=\"App\">\n      <button onClick={() => setPlay(true)}>begin</button>\n      {/* <div style={{height: '100%', width: 4, position: 'absolute', left: playheadTime, top: 0, backgroundColor: 'black', transition: '0.2s', zIndex: 999}}/> */}\n      {notes.map((note, i) => {\n        // const noteDescription = `${note.name} note: ${note.midi} dur:${note.duration} time:${note.time}`\n        const noteDescription = `${note.name}`\n        return <div\n          key={`${i}`}\n          style={{ position: 'absolute', left: note.time * DURATION_FACTOR - playheadTime, top: MAX_MIDI * NOTE_HEIGHT - note.midi * NOTE_HEIGHT, width: note.duration * DURATION_FACTOR, height: NOTE_HEIGHT, backgroundColor: 'tomato' }}\n        >{noteDescription}</div>\n      }\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}