{"ast":null,"code":"import _regeneratorRuntime from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _slicedToArray from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nexport var createRenderInputsOfAudioNode = function createRenderInputsOfAudioNode(getAudioNodeConnections, getAudioNodeRenderer, isPartOfACycle) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(audioNode, nativeOfflineAudioContext, nativeAudioNode, trace) {\n      var audioNodeConnections, nextTrace;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              audioNodeConnections = getAudioNodeConnections(audioNode);\n              nextTrace = [].concat(_toConsumableArray(trace), [audioNode]);\n              _context2.next = 4;\n              return Promise.all(audioNodeConnections.activeInputs.map(function (connections, input) {\n                return Array.from(connections).filter(function (_ref2) {\n                  var _ref3 = _slicedToArray(_ref2, 1),\n                      source = _ref3[0];\n\n                  return !nextTrace.includes(source);\n                }).map( /*#__PURE__*/function () {\n                  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref4) {\n                    var _ref6, source, output, audioNodeRenderer, renderedNativeAudioNode, destination;\n\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _ref6 = _slicedToArray(_ref4, 2), source = _ref6[0], output = _ref6[1];\n                            audioNodeRenderer = getAudioNodeRenderer(source);\n                            _context.next = 4;\n                            return audioNodeRenderer.render(source, nativeOfflineAudioContext, nextTrace);\n\n                          case 4:\n                            renderedNativeAudioNode = _context.sent;\n                            destination = audioNode.context.destination;\n\n                            if (!isPartOfACycle(source) && (audioNode !== destination || !isPartOfACycle(audioNode))) {\n                              renderedNativeAudioNode.connect(nativeAudioNode, output, input);\n                            }\n\n                          case 7:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function (_x5) {\n                    return _ref5.apply(this, arguments);\n                  };\n                }());\n              }).reduce(function (allRenderingPromises, renderingPromises) {\n                return [].concat(_toConsumableArray(allRenderingPromises), _toConsumableArray(renderingPromises));\n              }, []));\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x, _x2, _x3, _x4) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["../../../src/factories/render-inputs-of-audio-node.ts"],"names":[],"mappings":";;;;AAGA,OAAO,IAAM,6BAA6B,GAAoC,SAAjE,6BAAiE,CAC1E,uBAD0E,EAE1E,oBAF0E,EAG1E,cAH0E,EAI1E;AACA;AAAA,wEAAO,kBAAO,SAAP,EAAkB,yBAAlB,EAA6C,eAA7C,EAA8D,KAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AACG,cAAA,oBADH,GAC0B,uBAAuB,CAAC,SAAD,CADjD;AAEG,cAAA,SAFH,gCAEmB,KAFnB,IAE0B,SAF1B;AAAA;AAAA,qBAIG,OAAO,CAAC,GAAR,CACF,oBAAoB,CAAC,YAArB,CACK,GADL,CACS,UAAC,WAAD,EAAc,KAAd;AAAA,uBACD,KAAK,CAAC,IAAN,CAAW,WAAX,EACK,MADL,CACY;AAAA;AAAA,sBAAE,MAAF;;AAAA,yBAAc,CAAC,SAAS,CAAC,QAAV,CAAmB,MAAnB,CAAf;AAAA,iBADZ,EAEK,GAFL;AAAA,uFAES;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,8DAAQ,MAAR,aAAgB,MAAhB;AACK,4BAAA,iBADL,GACyB,oBAAoB,CAAC,MAAD,CAD7C;AAAA;AAAA,mCAEqC,iBAAiB,CAAC,MAAlB,CAAyB,MAAzB,EAAiC,yBAAjC,EAA4D,SAA5D,CAFrC;;AAAA;AAEK,4BAAA,uBAFL;AAGK,4BAAA,WAHL,GAGoE,SAAS,CAAC,OAAV,CAAkB,WAHtF;;AAKD,gCAAI,CAAC,cAAc,CAAC,MAAD,CAAf,KAA4B,SAAS,KAAK,WAAd,IAA6B,CAAC,cAAc,CAAC,SAAD,CAAxE,CAAJ,EAA0F;AACtF,8BAAA,uBAAuB,CAAC,OAAxB,CAAgC,eAAhC,EAAiD,MAAjD,EAAyD,KAAzD;AACH;;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAFT;;AAAA;AAAA;AAAA;AAAA,oBADC;AAAA,eADT,EAcK,MAdL,CAcY,UAAC,oBAAD,EAAuB,iBAAvB;AAAA,oDAAiD,oBAAjD,sBAA0E,iBAA1E;AAAA,eAdZ,EAc0G,EAd1G,CADE,CAJH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAsBH,CA3BM","sourceRoot":"","sourcesContent":["export const createRenderInputsOfAudioNode = (getAudioNodeConnections, getAudioNodeRenderer, isPartOfACycle) => {\n    return async (audioNode, nativeOfflineAudioContext, nativeAudioNode, trace) => {\n        const audioNodeConnections = getAudioNodeConnections(audioNode);\n        const nextTrace = [...trace, audioNode];\n        await Promise.all(audioNodeConnections.activeInputs\n            .map((connections, input) => Array.from(connections)\n            .filter(([source]) => !nextTrace.includes(source))\n            .map(async ([source, output]) => {\n            const audioNodeRenderer = getAudioNodeRenderer(source);\n            const renderedNativeAudioNode = await audioNodeRenderer.render(source, nativeOfflineAudioContext, nextTrace);\n            const destination = audioNode.context.destination;\n            if (!isPartOfACycle(source) && (audioNode !== destination || !isPartOfACycle(audioNode))) {\n                renderedNativeAudioNode.connect(nativeAudioNode, output, input);\n            }\n        }))\n            .reduce((allRenderingPromises, renderingPromises) => [...allRenderingPromises, ...renderingPromises], []));\n    };\n};\n//# sourceMappingURL=render-inputs-of-audio-node.js.map"]},"metadata":{},"sourceType":"module"}