{"ast":null,"code":"export var createCacheTestResult = function createCacheTestResult(ongoingTests, testResults) {\n  return function (tester, test) {\n    var cachedTestResult = testResults.get(tester);\n\n    if (cachedTestResult !== undefined) {\n      return cachedTestResult;\n    }\n\n    var ongoingTest = ongoingTests.get(tester);\n\n    if (ongoingTest !== undefined) {\n      return ongoingTest;\n    }\n\n    try {\n      var synchronousTestResult = test();\n\n      if (synchronousTestResult instanceof Promise) {\n        ongoingTests.set(tester, synchronousTestResult);\n        return synchronousTestResult.catch(function () {\n          return false;\n        }).then(function (finalTestResult) {\n          ongoingTests.delete(tester);\n          testResults.set(tester, finalTestResult);\n          return finalTestResult;\n        });\n      }\n\n      testResults.set(tester, synchronousTestResult);\n      return synchronousTestResult;\n    } catch (_unused) {\n      testResults.set(tester, false);\n      return false;\n    }\n  };\n};","map":{"version":3,"sources":["../../../src/factories/cache-test-result.ts"],"names":[],"mappings":"AAEA,OAAO,IAAM,qBAAqB,GAA4B,SAAjD,qBAAiD,CAAC,YAAD,EAAe,WAAf,EAA8B;AACxF,SAAO,UAAC,MAAD,EAAS,IAAT,EAAiB;AACpB,QAAM,gBAAgB,GAAG,WAAW,CAAC,GAAZ,CAAgB,MAAhB,CAAzB;;AAEA,QAAI,gBAAgB,KAAK,SAAzB,EAAoC;AAChC,aAAO,gBAAP;AACH;;AAED,QAAM,WAAW,GAAG,YAAY,CAAC,GAAb,CAAiB,MAAjB,CAApB;;AAEA,QAAI,WAAW,KAAK,SAApB,EAA+B;AAC3B,aAAO,WAAP;AACH;;AAED,QAAI;AACA,UAAM,qBAAqB,GAAG,IAAI,EAAlC;;AAEA,UAAI,qBAAqB,YAAY,OAArC,EAA8C;AAC1C,QAAA,YAAY,CAAC,GAAb,CAAiB,MAAjB,EAAyB,qBAAzB;AAEA,eAAO,qBAAqB,CACvB,KADE,CACI;AAAA,iBAAM,KAAN;AAAA,SADJ,EAEF,IAFE,CAEG,UAAC,eAAD,EAAoB;AACtB,UAAA,YAAY,CAAC,MAAb,CAAoB,MAApB;AACA,UAAA,WAAW,CAAC,GAAZ,CAAgB,MAAhB,EAAwB,eAAxB;AAEA,iBAAO,eAAP;AACH,SAPE,CAAP;AAQH;;AAED,MAAA,WAAW,CAAC,GAAZ,CAAgB,MAAhB,EAAwB,qBAAxB;AAEA,aAAO,qBAAP;AACH,KAnBD,CAmBE,gBAAM;AACJ,MAAA,WAAW,CAAC,GAAZ,CAAgB,MAAhB,EAAwB,KAAxB;AAEA,aAAO,KAAP;AACH;AACJ,GArCD;AAsCH,CAvCM","sourceRoot":"","sourcesContent":["export const createCacheTestResult = (ongoingTests, testResults) => {\n    return (tester, test) => {\n        const cachedTestResult = testResults.get(tester);\n        if (cachedTestResult !== undefined) {\n            return cachedTestResult;\n        }\n        const ongoingTest = ongoingTests.get(tester);\n        if (ongoingTest !== undefined) {\n            return ongoingTest;\n        }\n        try {\n            const synchronousTestResult = test();\n            if (synchronousTestResult instanceof Promise) {\n                ongoingTests.set(tester, synchronousTestResult);\n                return synchronousTestResult\n                    .catch(() => false)\n                    .then((finalTestResult) => {\n                    ongoingTests.delete(tester);\n                    testResults.set(tester, finalTestResult);\n                    return finalTestResult;\n                });\n            }\n            testResults.set(tester, synchronousTestResult);\n            return synchronousTestResult;\n        }\n        catch {\n            testResults.set(tester, false);\n            return false;\n        }\n    };\n};\n//# sourceMappingURL=cache-test-result.js.map"]},"metadata":{},"sourceType":"module"}