{"ast":null,"code":"import _classCallCheck from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _get from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/thebe/Desktop/music-generator-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { FeedbackEffect } from \"./FeedbackEffect\";\nimport { optionsFromArguments } from \"../core/util/Defaults\";\nimport { LFO } from \"../source/oscillator/LFO\";\nimport { Delay } from \"../core/context/Delay\";\nimport { CrossFade } from \"../component/channel/CrossFade\";\nimport { Signal } from \"../signal/Signal\";\nimport { readOnly } from \"../core/util/Interface\";\nimport { intervalToFrequencyRatio } from \"../core/type/Conversions\";\n/**\n * PitchShift does near-realtime pitch shifting to the incoming signal.\n * The effect is achieved by speeding up or slowing down the delayTime\n * of a DelayNode using a sawtooth wave.\n * Algorithm found in [this pdf](http://dsp-book.narod.ru/soundproc.pdf).\n * Additional reference by [Miller Pucket](http://msp.ucsd.edu/techniques/v0.11/book-html/node115.html).\n * @category Effect\n */\n\nexport var PitchShift = /*#__PURE__*/function (_FeedbackEffect) {\n  _inherits(PitchShift, _FeedbackEffect);\n\n  var _super = _createSuper(PitchShift);\n\n  function PitchShift() {\n    var _this;\n\n    _classCallCheck(this, PitchShift);\n\n    _this = _super.call(this, optionsFromArguments(PitchShift.getDefaults(), arguments, [\"pitch\"]));\n    _this.name = \"PitchShift\";\n    var options = optionsFromArguments(PitchShift.getDefaults(), arguments, [\"pitch\"]);\n    _this._frequency = new Signal({\n      context: _this.context\n    });\n    _this._delayA = new Delay({\n      maxDelay: 1,\n      context: _this.context\n    });\n    _this._lfoA = new LFO({\n      context: _this.context,\n      min: 0,\n      max: 0.1,\n      type: \"sawtooth\"\n    }).connect(_this._delayA.delayTime);\n    _this._delayB = new Delay({\n      maxDelay: 1,\n      context: _this.context\n    });\n    _this._lfoB = new LFO({\n      context: _this.context,\n      min: 0,\n      max: 0.1,\n      type: \"sawtooth\",\n      phase: 180\n    }).connect(_this._delayB.delayTime);\n    _this._crossFade = new CrossFade({\n      context: _this.context\n    });\n    _this._crossFadeLFO = new LFO({\n      context: _this.context,\n      min: 0,\n      max: 1,\n      type: \"triangle\",\n      phase: 90\n    }).connect(_this._crossFade.fade);\n    _this._feedbackDelay = new Delay({\n      delayTime: options.delayTime,\n      context: _this.context\n    });\n    _this.delayTime = _this._feedbackDelay.delayTime;\n    readOnly(_assertThisInitialized(_this), \"delayTime\");\n    _this._pitch = options.pitch;\n    _this._windowSize = options.windowSize; // connect the two delay lines up\n\n    _this._delayA.connect(_this._crossFade.a);\n\n    _this._delayB.connect(_this._crossFade.b); // connect the frequency\n\n\n    _this._frequency.fan(_this._lfoA.frequency, _this._lfoB.frequency, _this._crossFadeLFO.frequency); // route the input\n\n\n    _this.effectSend.fan(_this._delayA, _this._delayB);\n\n    _this._crossFade.chain(_this._feedbackDelay, _this.effectReturn); // start the LFOs at the same time\n\n\n    var now = _this.now();\n\n    _this._lfoA.start(now);\n\n    _this._lfoB.start(now);\n\n    _this._crossFadeLFO.start(now); // set the initial value\n\n\n    _this.windowSize = _this._windowSize;\n    return _this;\n  }\n\n  _createClass(PitchShift, [{\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(PitchShift.prototype), \"dispose\", this).call(this);\n\n      this._frequency.dispose();\n\n      this._delayA.dispose();\n\n      this._delayB.dispose();\n\n      this._lfoA.dispose();\n\n      this._lfoB.dispose();\n\n      this._crossFade.dispose();\n\n      this._crossFadeLFO.dispose();\n\n      this._feedbackDelay.dispose();\n\n      return this;\n    }\n  }, {\n    key: \"pitch\",\n\n    /**\n     * Repitch the incoming signal by some interval (measured in semi-tones).\n     * @example\n     * const pitchShift = new Tone.PitchShift().toDestination();\n     * const osc = new Tone.Oscillator().connect(pitchShift).start().toDestination();\n     * pitchShift.pitch = -12; // down one octave\n     * pitchShift.pitch = 7; // up a fifth\n     */\n    get: function get() {\n      return this._pitch;\n    },\n    set: function set(interval) {\n      this._pitch = interval;\n      var factor = 0;\n\n      if (interval < 0) {\n        this._lfoA.min = 0;\n        this._lfoA.max = this._windowSize;\n        this._lfoB.min = 0;\n        this._lfoB.max = this._windowSize;\n        factor = intervalToFrequencyRatio(interval - 1) + 1;\n      } else {\n        this._lfoA.min = this._windowSize;\n        this._lfoA.max = 0;\n        this._lfoB.min = this._windowSize;\n        this._lfoB.max = 0;\n        factor = intervalToFrequencyRatio(interval) - 1;\n      }\n\n      this._frequency.value = factor * (1.2 / this._windowSize);\n    }\n    /**\n     * The window size corresponds roughly to the sample length in a looping sampler.\n     * Smaller values are desirable for a less noticeable delay time of the pitch shifted\n     * signal, but larger values will result in smoother pitch shifting for larger intervals.\n     * A nominal range of 0.03 to 0.1 is recommended.\n     */\n\n  }, {\n    key: \"windowSize\",\n    get: function get() {\n      return this._windowSize;\n    },\n    set: function set(size) {\n      this._windowSize = this.toSeconds(size);\n      this.pitch = this._pitch;\n    }\n  }], [{\n    key: \"getDefaults\",\n    value: function getDefaults() {\n      return Object.assign(FeedbackEffect.getDefaults(), {\n        pitch: 0,\n        windowSize: 0.1,\n        delayTime: 0,\n        feedback: 0\n      });\n    }\n  }]);\n\n  return PitchShift;\n}(FeedbackEffect);","map":{"version":3,"sources":["../../../Tone/effect/PitchShift.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { FeedbackEffect } from \"./FeedbackEffect\";\nimport { optionsFromArguments } from \"../core/util/Defaults\";\nimport { LFO } from \"../source/oscillator/LFO\";\nimport { Delay } from \"../core/context/Delay\";\nimport { CrossFade } from \"../component/channel/CrossFade\";\nimport { Signal } from \"../signal/Signal\";\nimport { readOnly } from \"../core/util/Interface\";\nimport { intervalToFrequencyRatio } from \"../core/type/Conversions\";\n/**\n * PitchShift does near-realtime pitch shifting to the incoming signal.\n * The effect is achieved by speeding up or slowing down the delayTime\n * of a DelayNode using a sawtooth wave.\n * Algorithm found in [this pdf](http://dsp-book.narod.ru/soundproc.pdf).\n * Additional reference by [Miller Pucket](http://msp.ucsd.edu/techniques/v0.11/book-html/node115.html).\n * @category Effect\n */\nexport class PitchShift extends FeedbackEffect {\n    constructor() {\n        super(optionsFromArguments(PitchShift.getDefaults(), arguments, [\"pitch\"]));\n        this.name = \"PitchShift\";\n        const options = optionsFromArguments(PitchShift.getDefaults(), arguments, [\"pitch\"]);\n        this._frequency = new Signal({ context: this.context });\n        this._delayA = new Delay({\n            maxDelay: 1,\n            context: this.context\n        });\n        this._lfoA = new LFO({\n            context: this.context,\n            min: 0,\n            max: 0.1,\n            type: \"sawtooth\"\n        }).connect(this._delayA.delayTime);\n        this._delayB = new Delay({\n            maxDelay: 1,\n            context: this.context\n        });\n        this._lfoB = new LFO({\n            context: this.context,\n            min: 0,\n            max: 0.1,\n            type: \"sawtooth\",\n            phase: 180\n        }).connect(this._delayB.delayTime);\n        this._crossFade = new CrossFade({ context: this.context });\n        this._crossFadeLFO = new LFO({\n            context: this.context,\n            min: 0,\n            max: 1,\n            type: \"triangle\",\n            phase: 90\n        }).connect(this._crossFade.fade);\n        this._feedbackDelay = new Delay({\n            delayTime: options.delayTime,\n            context: this.context,\n        });\n        this.delayTime = this._feedbackDelay.delayTime;\n        readOnly(this, \"delayTime\");\n        this._pitch = options.pitch;\n        this._windowSize = options.windowSize;\n        // connect the two delay lines up\n        this._delayA.connect(this._crossFade.a);\n        this._delayB.connect(this._crossFade.b);\n        // connect the frequency\n        this._frequency.fan(this._lfoA.frequency, this._lfoB.frequency, this._crossFadeLFO.frequency);\n        // route the input\n        this.effectSend.fan(this._delayA, this._delayB);\n        this._crossFade.chain(this._feedbackDelay, this.effectReturn);\n        // start the LFOs at the same time\n        const now = this.now();\n        this._lfoA.start(now);\n        this._lfoB.start(now);\n        this._crossFadeLFO.start(now);\n        // set the initial value\n        this.windowSize = this._windowSize;\n    }\n    static getDefaults() {\n        return Object.assign(FeedbackEffect.getDefaults(), {\n            pitch: 0,\n            windowSize: 0.1,\n            delayTime: 0,\n            feedback: 0\n        });\n    }\n    /**\n     * Repitch the incoming signal by some interval (measured in semi-tones).\n     * @example\n     * const pitchShift = new Tone.PitchShift().toDestination();\n     * const osc = new Tone.Oscillator().connect(pitchShift).start().toDestination();\n     * pitchShift.pitch = -12; // down one octave\n     * pitchShift.pitch = 7; // up a fifth\n     */\n    get pitch() {\n        return this._pitch;\n    }\n    set pitch(interval) {\n        this._pitch = interval;\n        let factor = 0;\n        if (interval < 0) {\n            this._lfoA.min = 0;\n            this._lfoA.max = this._windowSize;\n            this._lfoB.min = 0;\n            this._lfoB.max = this._windowSize;\n            factor = intervalToFrequencyRatio(interval - 1) + 1;\n        }\n        else {\n            this._lfoA.min = this._windowSize;\n            this._lfoA.max = 0;\n            this._lfoB.min = this._windowSize;\n            this._lfoB.max = 0;\n            factor = intervalToFrequencyRatio(interval) - 1;\n        }\n        this._frequency.value = factor * (1.2 / this._windowSize);\n    }\n    /**\n     * The window size corresponds roughly to the sample length in a looping sampler.\n     * Smaller values are desirable for a less noticeable delay time of the pitch shifted\n     * signal, but larger values will result in smoother pitch shifting for larger intervals.\n     * A nominal range of 0.03 to 0.1 is recommended.\n     */\n    get windowSize() {\n        return this._windowSize;\n    }\n    set windowSize(size) {\n        this._windowSize = this.toSeconds(size);\n        this.pitch = this._pitch;\n    }\n    dispose() {\n        super.dispose();\n        this._frequency.dispose();\n        this._delayA.dispose();\n        this._delayB.dispose();\n        this._lfoA.dispose();\n        this._lfoB.dispose();\n        this._crossFade.dispose();\n        this._crossFadeLFO.dispose();\n        this._feedbackDelay.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=PitchShift.js.map"]},"metadata":{},"sourceType":"module"}