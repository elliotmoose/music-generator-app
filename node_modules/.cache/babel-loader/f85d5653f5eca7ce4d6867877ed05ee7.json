{"ast":null,"code":"var SYMBOLS = {\n  'm': ['m3', 'P5'],\n  'mi': ['m3', 'P5'],\n  'min': ['m3', 'P5'],\n  '-': ['m3', 'P5'],\n  'M': ['M3', 'P5'],\n  'ma': ['M3', 'P5'],\n  '': ['M3', 'P5'],\n  '+': ['M3', 'A5'],\n  'aug': ['M3', 'A5'],\n  'dim': ['m3', 'd5'],\n  'o': ['m3', 'd5'],\n  'maj': ['M3', 'P5', 'M7'],\n  'dom': ['M3', 'P5', 'm7'],\n  'ø': ['m3', 'd5', 'm7'],\n  '5': ['P5'],\n  '6/9': ['M3', 'P5', 'M6', 'M9']\n};\n\nmodule.exports = function (symbol) {\n  var c,\n      parsing = 'quality',\n      additionals = [],\n      name,\n      chordLength = 2;\n  var notes = ['P1', 'M3', 'P5', 'm7', 'M9', 'P11', 'M13'];\n  var explicitMajor = false;\n\n  function setChord(name) {\n    var intervals = SYMBOLS[name];\n\n    for (var i = 0, len = intervals.length; i < len; i++) {\n      notes[i + 1] = intervals[i];\n    }\n\n    chordLength = intervals.length;\n  } // Remove whitespace, commas and parentheses\n\n\n  symbol = symbol.replace(/[,\\s\\(\\)]/g, '');\n\n  for (var i = 0, len = symbol.length; i < len; i++) {\n    if (!(c = symbol[i])) return;\n\n    if (parsing === 'quality') {\n      var sub3 = i + 2 < len ? symbol.substr(i, 3).toLowerCase() : null;\n      var sub2 = i + 1 < len ? symbol.substr(i, 2).toLowerCase() : null;\n      if (sub3 in SYMBOLS) name = sub3;else if (sub2 in SYMBOLS) name = sub2;else if (c in SYMBOLS) name = c;else name = '';\n      if (name) setChord(name);\n      if (name === 'M' || name === 'ma' || name === 'maj') explicitMajor = true;\n      i += name.length - 1;\n      parsing = 'extension';\n    } else if (parsing === 'extension') {\n      c = c === '1' && symbol[i + 1] ? +symbol.substr(i, 2) : +c;\n\n      if (!isNaN(c) && c !== 6) {\n        chordLength = (c - 1) / 2;\n        if (chordLength !== Math.round(chordLength)) return new Error('Invalid interval extension: ' + c.toString(10));\n        if (name === 'o' || name === 'dim') notes[3] = 'd7';else if (explicitMajor) notes[3] = 'M7';\n        i += c >= 10 ? 1 : 0;\n      } else if (c === 6) {\n        notes[3] = 'M6';\n        chordLength = Math.max(3, chordLength);\n      } else i -= 1;\n\n      parsing = 'alterations';\n    } else if (parsing === 'alterations') {\n      var alterations = symbol.substr(i).split(/(#|b|add|maj|sus|M)/i),\n          next,\n          flat = false,\n          sharp = false;\n      if (alterations.length === 1) return new Error('Invalid alteration');else if (alterations[0].length !== 0) return new Error('Invalid token: \\'' + alterations[0] + '\\'');\n      var ignore = false;\n      alterations.forEach(function (alt, i, arr) {\n        if (ignore || !alt.length) return ignore = false;\n        var next = arr[i + 1],\n            lower = alt.toLowerCase();\n\n        if (alt === 'M' || lower === 'maj') {\n          if (next === '7') ignore = true;\n          chordLength = Math.max(3, chordLength);\n          notes[3] = 'M7';\n        } else if (lower === 'sus') {\n          var type = 'P4';\n\n          if (next === '2' || next === '4') {\n            ignore = true;\n            if (next === '2') type = 'M2';\n          }\n\n          notes[1] = type; // Replace third with M2 or P4\n        } else if (lower === 'add') {\n          if (next === '9') additionals.push('M9');else if (next === '11') additionals.push('P11');else if (next === '13') additionals.push('M13');\n          ignore = true;\n        } else if (lower === 'b') {\n          flat = true;\n        } else if (lower === '#') {\n          sharp = true;\n        } else {\n          var token = +alt,\n              quality,\n              intPos;\n          if (isNaN(token) || String(token).length !== alt.length) return new Error('Invalid token: \\'' + alt + '\\'');\n\n          if (token === 6) {\n            if (sharp) notes[3] = 'A6';else if (flat) notes[3] = 'm6';else notes[3] = 'M6';\n            chordLength = Math.max(3, chordLength);\n            return;\n          } // Calculate the position in the 'note' array\n\n\n          intPos = (token - 1) / 2;\n          if (chordLength < intPos) chordLength = intPos;\n          if (token < 5 || token === 7 || intPos !== Math.round(intPos)) return new Error('Invalid interval alteration: ' + token);\n          quality = notes[intPos][0]; // Alterate the quality of the interval according the accidentals\n\n          if (sharp) {\n            if (quality === 'd') quality = 'm';else if (quality === 'm') quality = 'M';else if (quality === 'M' || quality === 'P') quality = 'A';\n          } else if (flat) {\n            if (quality === 'A') quality = 'M';else if (quality === 'M') quality = 'm';else if (quality === 'm' || quality === 'P') quality = 'd';\n          }\n\n          sharp = flat = false;\n          notes[intPos] = quality + token;\n        }\n      });\n      parsing = 'ended';\n    } else if (parsing === 'ended') {\n      break;\n    }\n  }\n\n  return notes.slice(0, chordLength + 1).concat(additionals);\n};","map":{"version":3,"sources":["/Users/thebe/Desktop/music-generator-app/node_modules/daccord/index.js"],"names":["SYMBOLS","module","exports","symbol","c","parsing","additionals","name","chordLength","notes","explicitMajor","setChord","intervals","i","len","length","replace","sub3","substr","toLowerCase","sub2","isNaN","Math","round","Error","toString","max","alterations","split","next","flat","sharp","ignore","forEach","alt","arr","lower","type","push","token","quality","intPos","String","slice","concat"],"mappings":"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","sourcesContent":["var SYMBOLS = {\n  'm': ['m3', 'P5'],\n  'mi': ['m3', 'P5'],\n  'min': ['m3', 'P5'],\n  '-': ['m3', 'P5'],\n\n  'M': ['M3', 'P5'],\n  'ma': ['M3', 'P5'],\n  '': ['M3', 'P5'],\n\n  '+': ['M3', 'A5'],\n  'aug': ['M3', 'A5'],\n\n  'dim': ['m3', 'd5'],\n  'o': ['m3', 'd5'],\n\n  'maj': ['M3', 'P5', 'M7'],\n  'dom': ['M3', 'P5', 'm7'],\n  'ø': ['m3', 'd5', 'm7'],\n\n  '5': ['P5'],\n\n  '6/9': ['M3', 'P5', 'M6', 'M9']\n};\n\nmodule.exports = function(symbol) {\n  var c, parsing = 'quality', additionals = [], name, chordLength = 2\n  var notes = ['P1', 'M3', 'P5', 'm7', 'M9', 'P11', 'M13'];\n  var explicitMajor = false;\n\n  function setChord(name) {\n    var intervals = SYMBOLS[name];\n    for (var i = 0, len = intervals.length; i < len; i++) {\n      notes[i + 1] = intervals[i];\n    }\n\n    chordLength = intervals.length;\n  }\n\n  // Remove whitespace, commas and parentheses\n  symbol = symbol.replace(/[,\\s\\(\\)]/g, '');\n  for (var i = 0, len = symbol.length; i < len; i++) {\n    if (!(c = symbol[i]))\n      return;\n\n    if (parsing === 'quality') {\n      var sub3 = (i + 2) < len ? symbol.substr(i, 3).toLowerCase() : null;\n      var sub2 = (i + 1) < len ? symbol.substr(i, 2).toLowerCase() : null;\n      if (sub3 in SYMBOLS)\n        name = sub3;\n      else if (sub2 in SYMBOLS)\n        name = sub2;\n      else if (c in SYMBOLS)\n        name = c;\n      else\n        name = '';\n\n      if (name)\n        setChord(name);\n\n      if (name === 'M' || name === 'ma' || name === 'maj')\n        explicitMajor = true;\n\n\n      i += name.length - 1;\n      parsing = 'extension';\n    } else if (parsing === 'extension') {\n      c = (c === '1' && symbol[i + 1]) ? +symbol.substr(i, 2) : +c;\n\n      if (!isNaN(c) && c !== 6) {\n        chordLength = (c - 1) / 2;\n\n        if (chordLength !== Math.round(chordLength))\n          return new Error('Invalid interval extension: ' + c.toString(10));\n\n        if (name === 'o' || name === 'dim')\n          notes[3] = 'd7';\n        else if (explicitMajor)\n          notes[3] = 'M7';\n\n        i += c >= 10 ? 1 : 0;\n      } else if (c === 6) {\n        notes[3] = 'M6';\n        chordLength = Math.max(3, chordLength);\n      } else\n        i -= 1;\n\n      parsing = 'alterations';\n    } else if (parsing === 'alterations') {\n      var alterations = symbol.substr(i).split(/(#|b|add|maj|sus|M)/i),\n          next, flat = false, sharp = false;\n\n      if (alterations.length === 1)\n        return new Error('Invalid alteration');\n      else if (alterations[0].length !== 0)\n        return new Error('Invalid token: \\'' + alterations[0] + '\\'');\n\n      var ignore = false;\n      alterations.forEach(function(alt, i, arr) {\n        if (ignore || !alt.length)\n          return ignore = false;\n\n        var next = arr[i + 1], lower = alt.toLowerCase();\n        if (alt === 'M' || lower === 'maj') {\n          if (next === '7')\n            ignore = true;\n\n          chordLength = Math.max(3, chordLength);\n          notes[3] = 'M7';\n        } else if (lower === 'sus') {\n          var type = 'P4';\n          if (next === '2' || next === '4') {\n            ignore = true;\n\n            if (next === '2')\n              type = 'M2';\n          }\n\n          notes[1] = type; // Replace third with M2 or P4\n        } else if (lower === 'add') {\n          if (next === '9')\n            additionals.push('M9');\n          else if (next === '11')\n            additionals.push('P11');\n          else if (next === '13')\n            additionals.push('M13');\n\n          ignore = true\n        } else if (lower === 'b') {\n          flat = true;\n        } else if (lower === '#') {\n          sharp = true;\n        } else {\n          var token = +alt, quality, intPos;\n          if (isNaN(token) || String(token).length !== alt.length)\n            return new Error('Invalid token: \\'' + alt + '\\'');\n\n          if (token === 6) {\n            if (sharp)\n              notes[3] = 'A6';\n            else if (flat)\n              notes[3] = 'm6';\n            else\n              notes[3] = 'M6';\n\n            chordLength = Math.max(3, chordLength);\n            return;\n          }\n\n          // Calculate the position in the 'note' array\n          intPos = (token - 1) / 2;\n          if (chordLength < intPos)\n            chordLength = intPos;\n\n          if (token < 5 || token === 7 || intPos !== Math.round(intPos))\n            return new Error('Invalid interval alteration: ' + token);\n\n          quality = notes[intPos][0];\n\n          // Alterate the quality of the interval according the accidentals\n          if (sharp) {\n            if (quality === 'd')\n              quality = 'm';\n            else if (quality === 'm')\n              quality = 'M';\n            else if (quality === 'M' || quality === 'P')\n              quality = 'A';\n          } else if (flat) {\n            if (quality === 'A')\n              quality = 'M';\n            else if (quality === 'M')\n              quality = 'm';\n            else if (quality === 'm' || quality === 'P')\n              quality = 'd';\n          }\n\n          sharp = flat = false;\n          notes[intPos] = quality + token;\n        }\n      });\n      parsing = 'ended';\n    } else if (parsing === 'ended') {\n      break;\n    }\n  }\n\n  return notes.slice(0, chordLength + 1).concat(additionals);\n}\n"]},"metadata":{},"sourceType":"script"}